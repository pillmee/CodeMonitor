# CodeMonitor

CodeMonitor는 Git 저장소 활동을 모니터링하고 여러 프로젝트의 코드 라인(LOC) 증가 및 이력을 시각화하는 강력한 도구입니다. Android Framework와 같은 대규모 소스 코드베이스에서도 초고속 분석과 실시간 대시보드를 제공합니다.

## 주요 기능

- **멀티 저장소 추적**: 여러 Git 저장소를 등록하고 통합/개별적으로 모니터링할 수 있습니다.
- **특정 디렉토리 모니터링**: 저장소 전체가 아닌 특정 하위 경로(`include_path`)만 한정하여 분석할 수 있습니다.
- **역사적 LOC 분석 (Backfill)**: 과거 커밋을 자동으로 전수 조사하여 첫 커밋부터 현재까지의 전체 이력 데이터를 실시간으로 구축합니다.
- **인터랙티브 대시보드**: 
  - **Zoom & Pan**: 그래프 확대/축소 및 시점 이동 기능을 통한 정밀 분석 지원.
  - **델타(Delta) 가이드**: 툴팁에서 직전 데이터 포인트 대비 증감량(▲/▼)을 즉시 확인 가능.
- **저장소 관리**: 필요 없는 저장소를 대시보드에서 즉시 삭제하고 데이터를 정리할 수 있습니다.
- **스마트 브라우저 연결**: 서버 호스트 IP를 자동으로 감지하여 원격 접속 시에도 별도 설정 없이 API 연동이 가능합니다.

## LOC 계산 알고리즘 (Algorithm)

CodeMonitor는 대규모 저장소의 성능 최적화를 위해 **"Git Log 증분 누적 합산"** 알고리즘을 사용합니다.

1. **로그 추출**: `git log --reverse --numstat` 명령을 통해 저장소의 첫 커밋부터 최신 커밋까지의 변경 내역을 순차적으로 읽어들입니다.
2. **증분 계산**: 각 커밋 호스트에서 리턴하는 추가된 라인(insertions)과 삭제된 라인(deletions) 정보를 파싱합니다.
3. **누적 합산**: 
   - `현재 총 라인수 = 이전 커밋 총 라인수 + 추가된 라인 - 삭제된 라인`
   - 초기값은 0에서 시작하며, 음수가 발생하지 않도록 하한선(0) 보정 로직이 포함되어 있습니다.
4. **성능 최적화**: 커밋 데이터를 500개 단위로 묶어(Batch) DB에 삽입하여 대량의 히스토리를 수십 초 내에 처리합니다.

## 사전 요구 사항

- **운영체제**: macOS 또는 Linux (Ubuntu/Debian 권장)
- **Git**: 최신 버전 설치 권장.
- **Python**: 3.10 이상 버전.
- **Node.js**: 18 이상 버전.
- **cloc**: 시스템에 설치되어 있어야 합니다. (초기 오차 보정용)

## 설치 및 설정

`implements` 디렉토리로 이동하여 설정 스크립트를 실행하세요:

```bash
cd implements
./setup.sh
```

## 실행 방법

`run.sh` 스크립트를 사용하여 백엔드와 프론트엔드 서버를 동시에 실행합니다:

```bash
cd implements
./run.sh
```

### 실행 옵션

```bash
./run.sh -b [백엔드포트] -f [프론트엔드포트]
```

## 프로젝트 구조

- `implements/backend`: FastAPI 및 Git 분석 엔진/워커.
- `implements/frontend`: Vite + React 기반 대시보드 UI.
- `docs/PRD.md`: 상세 제품 요구사항 정의서.

## 라이선스

MIT License
